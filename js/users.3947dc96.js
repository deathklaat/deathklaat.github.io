(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["users"],{"151a":function(e,t,s){},7488:function(e,t,s){"use strict";s("151a")},"753a":function(e,t,s){"use strict";s("ef17")},7957:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"users-page page"},[s("div",{staticClass:"page__title"},[s("nav-back"),e._v(" Список пользователей "),s("ui-button",{staticClass:"page__add-button",attrs:{color:"blue"},on:{clicked:e.onAddUserClick}},[e._v(" Добавить ")])],1),s("table",{staticClass:"users-list table table-striped"},[e._m(0),s("tbody",e._l(e.users,(function(t,a){return s("tr",{key:a},[s("th",{attrs:{scope:"row"}},[e._v(e._s(t.id))]),s("td",[e._v(e._s(t.email))]),s("td",[s("svg",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"bi bi-pencil page__active-icon",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",title:"Редактировать"},on:{click:function(s){return e.onEditClick(t)}}},[s("path",{attrs:{d:"M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z"}})]),s("svg",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"bi bi-trash ms-3 page__active-icon",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",title:"Удалить"},on:{click:function(s){return e.onDeleteClick(t.id)}}},[s("path",{attrs:{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"}}),s("path",{attrs:{"fill-rule":"evenodd",d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"}})]),s("svg",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"bi bi-shield-lock page__active-icon",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",title:"Сменить пароль"},on:{click:function(s){return e.onChangePasswordClick(t)}}},[s("path",{attrs:{d:"M5.338 1.59a61.44 61.44 0 0 0-2.837.856.481.481 0 0 0-.328.39c-.554 4.157.726 7.19 2.253 9.188a10.725 10.725 0 0 0 2.287 2.233c.346.244.652.42.893.533.12.057.218.095.293.118a.55.55 0 0 0 .101.025.615.615 0 0 0 .1-.025c.076-.023.174-.061.294-.118.24-.113.547-.29.893-.533a10.726 10.726 0 0 0 2.287-2.233c1.527-1.997 2.807-5.031 2.253-9.188a.48.48 0 0 0-.328-.39c-.651-.213-1.75-.56-2.837-.855C9.552 1.29 8.531 1.067 8 1.067c-.53 0-1.552.223-2.662.524zM5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.775 11.775 0 0 1-2.517 2.453 7.159 7.159 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7.158 7.158 0 0 1-1.048-.625 11.777 11.777 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 62.456 62.456 0 0 1 5.072.56z"}}),s("path",{attrs:{d:"M9.5 6.5a1.5 1.5 0 0 1-1 1.415l.385 1.99a.5.5 0 0 1-.491.595h-.788a.5.5 0 0 1-.49-.595l.384-1.99a1.5 1.5 0 1 1 2-1.415z"}})])])])})),0)])])},r=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("thead",[s("tr",[s("th",{attrs:{scope:"col"}},[e._v("ID")]),s("th",{attrs:{scope:"col"}},[e._v("Email")]),s("th",{attrs:{scope:"col"}},[e._v("Действия")])])])}],i=s("1da1"),n=s("5530"),o=(s("96cf"),s("d3b7"),s("3ca3"),s("ddb0"),s("25f0"),s("2f62")),l=s("bc87"),c=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"modal-popup edit-user-modal",on:{keyup:function(t){return t.type.indexOf("key")||13===t.keyCode?e.onSaveClick.apply(null,arguments):null}}},[s("div",{staticClass:"mb-3 modal-popup__title"},[e._v(" Редактирование пользователя "),s("svg",{staticClass:"bi bi-x-lg modal-popup__close",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"#2D4C70",viewBox:"0 0 16 16"},on:{click:e.close}},[s("path",{attrs:{d:"M1.293 1.293a1 1 0 0 1 1.414 0L8 6.586l5.293-5.293a1 1 0 1 1 1.414 1.414L9.414 8l5.293 5.293a1 1 0 0 1-1.414 1.414L8 9.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L6.586 8 1.293 2.707a1 1 0 0 1 0-1.414z"}})])]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],ref:"input",staticClass:"form-control mb-2",class:[e.validationClass()],attrs:{type:"email",placeholder:"Email address"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}}),s("div",{staticClass:"modal-popup__permissions"},[s("label",{staticClass:"modal-popup__permission-text",attrs:{for:"permissionSelect"}},[e._v("Права доступа")]),s("select",{ref:"permissionSelect",staticClass:"form-select",attrs:{size:e.permissions.length+1,multiple:"","aria-label":"multiple select",id:"permissionSelect"}},e._l(e.permissions,(function(t,a){return s("option",{key:a,domProps:{value:t.id,selected:e.user.permissions.includes(t.id)}},[e._v(e._s(t.name)+" ")])})),0)]),s("ui-button",{staticClass:"mt-3 mb-2",on:{clicked:e.onSaveClick}},[e._v("Сохранить")]),e.alert.length?s("div",{staticClass:"alert alert-danger",attrs:{role:"alert"}},[e._v(e._s(e.alert))]):e._e()],1)},u=[],d=(s("159b"),s("b64b"),s("ed08")),p={props:["user"],data:function(){return{email:"",alert:""}},computed:{permissions:function(){return this.$store.state.permissions.list}},components:{UiButton:function(){return s.e("chunk-7a628425").then(s.bind(null,"832a"))}},mounted:function(){this.email=this.user.email,this.$refs.input.focus()},methods:Object(n["a"])(Object(n["a"])({},Object(o["b"])("users",["updateUser"])),{},{resetAlert:function(){this.canReset&&(this.alert="",this.canReset=!1)},setAlert:function(e){var t=this;this.alert=e,setTimeout((function(){t.canReset=!0}),250)},validationClass:function(){return""===this.email?"":Object(d["f"])(this.email)?"email-valid":"email-invalid"},onSaveClick:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var s,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(Object(d["f"])(e.email)){t.next=3;break}return e.setAlert("Введен некорректный email"),t.abrupt("return",!1);case 3:if(s=[],e.$refs.permissionSelect.forEach((function(e){e.selected&&s.push(parseInt(e.value,10))})),s.length){t.next=8;break}return e.setAlert("Необходимо выбрать права доступа"),t.abrupt("return",!1);case 8:if(a={},e.email!==e.user.email&&(a.email=e.email),Object(d["a"])(s,e.user.permissions)||(a.permissions=s),Object.keys(a).length){t.next=14;break}return e.setAlert("Вы не изменили никаких данных"),t.abrupt("return",!1);case 14:return a.id=e.user.id,t.next=17,e.updateUser(a);case 17:r=t.sent,r.error?e.setAlert("Ошибка обновления пользователя"):e.close();case 19:case"end":return t.stop()}}),t)})))()},close:function(){this.$modal.hide("edit-user-modal")}})},m=p,h=s("2877"),v=Object(h["a"])(m,c,u,!1,null,null,null),f=v.exports,w=function(e){var t=new l["a"]({component:f,props:{user:e},params:{transition:"scale",name:"edit-user-modal",width:"100%",height:"100%",classes:"edit-user-modal__overlay"}});t.show()},b=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"modal-popup",on:{click:e.resetAlert,keyup:function(t){return t.type.indexOf("key")||13===t.keyCode?e.onAddUserClick.apply(null,arguments):null}}},[s("div",{staticClass:"mb-3 modal-popup__title"},[e._v(" Добавление пользователя "),s("svg",{staticClass:"bi bi-x-lg modal-popup__close",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"#2D4C70",viewBox:"0 0 16 16"},on:{click:e.close}},[s("path",{attrs:{d:"M1.293 1.293a1 1 0 0 1 1.414 0L8 6.586l5.293-5.293a1 1 0 1 1 1.414 1.414L9.414 8l5.293 5.293a1 1 0 0 1-1.414 1.414L8 9.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L6.586 8 1.293 2.707a1 1 0 0 1 0-1.414z"}})])]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],ref:"input",staticClass:"form-control mb-2",class:[e.validationClass()],attrs:{type:"email",placeholder:"Email"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}}),s("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"form-control mb-2",attrs:{type:"password",placeholder:"Пароль"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),s("input",{directives:[{name:"model",rawName:"v-model",value:e.confirmPassword,expression:"confirmPassword"}],staticClass:"form-control mb-2",attrs:{type:"password",placeholder:"Подтверждение пароля"},domProps:{value:e.confirmPassword},on:{input:function(t){t.target.composing||(e.confirmPassword=t.target.value)}}}),s("div",{staticClass:"modal-popup__permissions"},[s("label",{staticClass:"modal-popup__permission-text",attrs:{for:"permissionSelect"}},[e._v("Права доступа")]),s("select",{ref:"permissionSelect",staticClass:"form-select",attrs:{size:e.permissions.length+1,multiple:"","aria-label":"multiple select",id:"permissionSelect"}},e._l(e.permissions,(function(t,a){return s("option",{key:a,domProps:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])})),0)]),s("ui-button",{staticClass:"mt-3 mb-2",attrs:{disabled:!e.isValidData()},on:{clicked:e.onAddUserClick}},[e._v("Добавить")]),e.alert.length?s("div",{staticClass:"alert alert-danger",attrs:{role:"alert"}},[e._v(e._s(e.alert))]):e._e()],1)},g=[],_={data:function(){return{email:"",password:"",confirmPassword:"",alert:"",canReset:!1}},computed:{permissions:function(){return this.$store.state.permissions.list}},mounted:function(){this.$refs.input.focus()},components:{UiButton:function(){return s.e("chunk-7a628425").then(s.bind(null,"832a"))}},methods:Object(n["a"])(Object(n["a"])({},Object(o["b"])("users",["addUser"])),{},{resetAlert:function(){this.canReset&&(this.alert="",this.canReset=!1)},setAlert:function(e){var t=this;this.alert=e,setTimeout((function(){t.canReset=!0}),250)},validationClass:function(){return""===this.email?"":Object(d["f"])(this.email)?"email-valid":"email-invalid"},isValidData:function(){if(!Object(d["f"])(this.email))return this.setAlert("Введен некорректный email"),!1;if(""===this.password)return this.setAlert("Необходимо ввести пароль"),!1;if(this.password!==this.confirmPassword)return this.setAlert("Пароли должны совпадать"),!1;var e=[];return this.$refs.permissionSelect.forEach((function(t){t.selected&&e.push(parseInt(t.value,10))})),e.length?(this.alert="",!0):(this.setAlert("Необходимо выбрать права доступа"),!1)},onAddUserClick:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var s,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.isValidData()){t.next=2;break}return t.abrupt("return",!1);case 2:return s=[],e.$refs.permissionSelect.forEach((function(e){e.selected&&s.push(parseInt(e.value,10))})),t.next=6,e.addUser({email:e.email,password:e.password,permissions:s});case 6:a=t.sent,a.error?a.error.response.data.email?e.setAlert(a.error.response.data.email[0]):e.setAlert("Ошибка: ".concat(a.error.toString())):e.close();case 8:case"end":return t.stop()}}),t)})))()},close:function(){this.$modal.hide("add-user-modal")}})},C=_,k=Object(h["a"])(C,b,g,!1,null,null,null),x=k.exports,O=function(){var e=new l["a"]({component:x,props:{},params:{transition:"scale",name:"add-user-modal",width:"100%",height:"100%",classes:"add-user-modal__overlay"}});e.show()},j=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"modal-popup change-user-password-modal"},[s("div",{staticClass:"mb-3 modal-popup__title"},[e._v(" Смена пароля "),s("svg",{staticClass:"bi bi-x-lg modal-popup__close",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"#2D4C70",viewBox:"0 0 16 16"},on:{click:e.close}},[s("path",{attrs:{d:"M1.293 1.293a1 1 0 0 1 1.414 0L8 6.586l5.293-5.293a1 1 0 1 1 1.414 1.414L9.414 8l5.293 5.293a1 1 0 0 1-1.414 1.414L8 9.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L6.586 8 1.293 2.707a1 1 0 0 1 0-1.414z"}})])]),s("input",{ref:"input",staticClass:"form-control mb-2",attrs:{type:"email",disabled:"",placeholder:"Email address"},domProps:{value:e.user.email}}),s("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"form-control mb-2",attrs:{type:"password",placeholder:"Новый пароль"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),s("input",{directives:[{name:"model",rawName:"v-model",value:e.confirmedPassword,expression:"confirmedPassword"}],staticClass:"form-control mb-2",class:[e.validationClass()],attrs:{type:"password",placeholder:"Подтверждение пароля"},domProps:{value:e.confirmedPassword},on:{input:function(t){t.target.composing||(e.confirmedPassword=t.target.value)}}}),s("ui-button",{staticClass:"mt-3 mb-2",attrs:{disabled:!e.isValidData()},on:{clicked:e.onSaveClick}},[e._v("Сохранить")]),e.alert.length?s("div",{staticClass:"alert alert-danger",attrs:{role:"alert"}},[e._v(e._s(e.alert))]):e._e()],1)},A=[],y=s("a70a"),P={props:["user"],data:function(){return{password:"",confirmedPassword:"",alert:""}},components:{UiButton:function(){return s.e("chunk-7a628425").then(s.bind(null,"832a"))}},mounted:function(){this.$refs.input.focus()},methods:Object(n["a"])(Object(n["a"])({},Object(o["b"])("users",["updateUser"])),{},{validationClass:function(){return this.password?this.password===this.confirmedPassword?"password-valid":"password-invalid":""},isValidData:function(){return this.password?this.password!==this.confirmedPassword?(this.setAlert("Пароли должны совпадать"),!1):(this.alert="",!0):(this.setAlert("Необходимо ввести пароль"),!1)},resetAlert:function(){this.canReset&&(this.alert="",this.canReset=!1)},setAlert:function(e){var t=this;this.alert=e,setTimeout((function(){t.canReset=!0}),250)},onSaveClick:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var s,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.isValidData()){t.next=2;break}return t.abrupt("return");case 2:return s={id:e.user.id,password:e.password},t.next=5,e.updateUser(s);case 5:a=t.sent,a.error?e.setAlert("Ошибка: ".concat(a.error.toString())):(y["a"].$emit("show-notification-message","Обновлено"),e.close());case 7:case"end":return t.stop()}}),t)})))()},close:function(){this.$modal.hide("change-user-password-modal")}})},$=P,U=(s("753a"),Object(h["a"])($,j,A,!1,null,null,null)),z=U.exports,R=function(e){var t=new l["a"]({component:z,props:{user:e},params:{transition:"scale",name:"change-user-password-modal",width:"100%",height:"100%",classes:"change-user-password-modal__overlay"}});t.show()},S={components:{UiButton:function(){return s.e("chunk-7a628425").then(s.bind(null,"832a"))},NavBack:function(){return s.e("chunk-49c533a1").then(s.bind(null,"e019"))}},created:function(){this.getUsers()},computed:{users:function(){return this.$store.state.users.list}},methods:Object(n["a"])(Object(n["a"])({},Object(o["b"])("users",["getUsers","deleteUser"])),{},{onEditClick:function(e){w(e)},onDeleteClick:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){var a;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(confirm("Подтвердите удаление")){s.next=2;break}return s.abrupt("return");case 2:return s.next=4,t.deleteUser(e);case 4:a=s.sent,a.error&&y["a"].$emit("show-notification-message","Ошибка: ".concat(a.error.toString()));case 6:case"end":return s.stop()}}),s)})))()},onAddUserClick:function(){O()},onChangePasswordClick:function(e){R(e)}})},V=S,E=(s("7488"),Object(h["a"])(V,a,r,!1,null,null,null));t["default"]=E.exports},bc87:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var a=s("d4ec"),r=s("bee2"),i=(s("b0c0"),s("1881")),n=s.n(i),o=function(){function e(t){var s=t.component,r=t.props,i=void 0===r?{}:r,n=t.params,o=void 0===n?{}:n,l=t.events,c=void 0===l?{}:l;Object(a["a"])(this,e),this.component=s,this.props=i,this.params=o,this.events={opened:function(){Object.assign(s,{modalName:o.name})},closed:function(){}},Object.assign(this.events,c)}return Object(r["a"])(e,[{key:"show",value:function(){n.a.rootInstance.$modal.show(this.component,this.props,this.params,this.events)}},{key:"hide",value:function(){n.a.rootInstance.$emit("close")}}]),e}()},ef17:function(e,t,s){}}]);
//# sourceMappingURL=users.3947dc96.js.map