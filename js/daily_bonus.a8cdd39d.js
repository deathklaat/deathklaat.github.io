(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["daily_bonus"],{"5ef3":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page daily-bonus-page"},[n("div",{staticClass:"page__title"},[n("nav-back"),t._v(" Ежедневный бонус "),n("ui-button",{staticClass:"page__title-button",attrs:{color:"blue",disabled:!t.anyChanges},on:{clicked:t.onSaveClick}},[t._v(" Сохранить ")])],1),t.pageIsReady?[n("div",{staticClass:"daily-bonus-page__status"},[n("label",{staticClass:"my-0"},[t._v("Статус:")]),n("b-dropdown",{attrs:{text:t.statusText}},t._l(t.statusOptions,(function(e,a){return n("b-dropdown-item",{key:a,attrs:{"data-value":e.value},on:{click:t.onStatusSelect}},[t._v(" "+t._s(e.name)+" ")])})),1)],1),n("div",{staticClass:"daily-bonus-page__items-list"},[n("draggable",t._b({staticClass:"list-group",attrs:{tag:"ul",move:t.onItemMoved},on:{start:function(e){t.dragging=!0},end:function(e){t.dragging=!1},change:t.onOrderChanged},model:{value:t.items,callback:function(e){t.items=e},expression:"items"}},"draggable",t.dragOptions,!1),[n("transition-group",{staticClass:"d-flex flex-wrap",attrs:{type:"transition",name:"flip-list"}},t._l(t.items,(function(e){return n("li",{key:e.id,staticClass:"list-group-item daily-bonus-page__item"},[n("daily-bonus-item",{ref:"dailyBonusItems",refInFor:!0,attrs:{"initial-data":e},on:{changed:t.onItemSettingsChanged,deleted:t.onDeleteItem}})],1)})),0)],1),n("ui-button",{staticClass:"float-left mt-3",attrs:{color:"blue"},on:{clicked:t.onAddDayClick}},[t._v(" Добавить день ")])],1)]:t._e()],2)},s=[],i=n("5530"),o=n("1da1"),r=(n("96cf"),n("d3b7"),n("3ca3"),n("ddb0"),n("b0c0"),n("7db0"),n("159b"),n("25f0"),n("a434"),n("b76a")),u=n.n(r),c=n("2f62"),l=n("a70a"),d={data:function(){return{pageIsReady:!1,anyChanges:!1,items:[],dragging:!1,dragLocked:!1,statusText:"",statusOption:1,statusOptions:[{value:1,name:"Включено"},{value:0,name:"Выключено"}]}},components:{draggable:u.a,UiButton:function(){return n.e("chunk-7a628425").then(n.bind(null,"832a"))},NavBack:function(){return n.e("chunk-49c533a1").then(n.bind(null,"e019"))},DailyBonusItem:function(){return n.e("chunk-735da00f").then(n.bind(null,"5bb0"))}},computed:{dragOptions:function(){return{animation:0,group:"description",disabled:!1,ghostClass:"ghost",direction:"vertical"}}},created:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getConfig();case 2:t.statusOption=t.$store.state.firebase.config.DailyBonuses.is_enabled?1:0,t.statusText=t.statusOptions.find((function(e){return e.value===t.statusOption})).name,t.items=t.$store.state.firebase.config.DailyBonuses.bonuses,t.pageIsReady=!0;case 6:case"end":return e.stop()}}),e)})))()},methods:Object(i["a"])(Object(i["a"])({},Object(c["b"])("firebase",["getConfig","updateDailyBonusesConfig"])),{},{onOrderChanged:function(){var t=this;this.items.forEach((function(e,n){e.id=n+1,t.$refs.dailyBonusItems[n].setData(e)})),this.anyChanges=!0},onItemMoved:function(){return!this.dragLocked},onItemSettingsChanged:function(t,e,n){var a=this.items.find((function(e){return e.id===t}));a&&a.hasOwnProperty(e)&&(a[e]=n,this.anyChanges=!0)},onSaveClick:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var n,a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.anyChanges){e.next=2;break}return e.abrupt("return");case 2:for(n=[],a=0;a<t.$refs.dailyBonusItems.length;a++)n.push(t.$refs.dailyBonusItems[a].getData());return e.next=6,t.updateDailyBonusesConfig({is_enabled:1===t.statusOption,bonuses:n});case 6:s=e.sent,s.error?l["a"].$emit("show-notification-message","Ошибка: ".concat(s.error.toString())):l["a"].$emit("show-notification-message","Сохранено"),t.anyChanges=!1;case 9:case"end":return e.stop()}}),e)})))()},onAddDayClick:function(){this.items.push({id:this.items.length+1,available:!0,is_completed:!1,ads_bonus:0,reward:{id:1,value:0},vip_reward:{id:1,value:0}}),this.anyChanges=!0},onDeleteItem:function(t){var e=this;confirm("Вы точно хотите удалить День #".concat(t,"?"))&&(this.items.splice(t-1,1),this.items.forEach((function(t,n){t.id=n+1,e.$refs.dailyBonusItems[n].setData(t)})),this.anyChanges=!0)},onStatusSelect:function(t){var e=this;this.statusOption=parseInt(t.target.dataset.value,10),this.statusText=this.statusOptions.find((function(t){return t.value===e.statusOption})).name,this.anyChanges=!0}})},f=d,g=(n("ffea"),n("2877")),h=Object(g["a"])(f,a,s,!1,null,null,null);e["default"]=h.exports},a3b5:function(t,e,n){},ffea:function(t,e,n){"use strict";n("a3b5")}}]);
//# sourceMappingURL=daily_bonus.a8cdd39d.js.map