{"version":3,"sources":["webpack:///./src/views/Firebase/DailyBonus.vue?eac7","webpack:///src/views/Firebase/DailyBonus.vue","webpack:///./src/views/Firebase/DailyBonus.vue?8b0b","webpack:///./src/views/Firebase/DailyBonus.vue","webpack:///./src/views/Firebase/DailyBonus.vue?6423"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","attrs","anyChanges","on","onSaveClick","statusText","_l","status","i","key","value","onStatusSelect","_s","name","_b","onItemMoved","$event","dragging","onOrderChanged","model","callback","$$v","items","expression","dragOptions","item","id","ref","refInFor","onItemSettingsChanged","onDeleteItem","onAddDayClick","_e","staticRenderFns","component"],"mappings":"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","file":"js/daily_bonus.b72a5d16.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"page daily-bonus-page\"},[_c('div',{staticClass:\"page__title\"},[_c('nav-back'),_vm._v(\" Ежедневный бонус \"),_c('ui-button',{staticClass:\"page__title-button\",attrs:{\"color\":\"blue\",\"disabled\":!_vm.anyChanges},on:{\"clicked\":_vm.onSaveClick}},[_vm._v(\" Сохранить \")])],1),(_vm.pageIsReady)?[_c('div',{staticClass:\"daily-bonus-page__status\"},[_c('label',{staticClass:\"my-0\"},[_vm._v(\"Статус:\")]),_c('b-dropdown',{attrs:{\"text\":_vm.statusText}},_vm._l((_vm.statusOptions),function(status,i){return _c('b-dropdown-item',{key:i,attrs:{\"data-value\":status.value},on:{\"click\":_vm.onStatusSelect}},[_vm._v(\" \"+_vm._s(status.name)+\" \")])}),1)],1),_c('div',{staticClass:\"daily-bonus-page__items-list\"},[_c('draggable',_vm._b({staticClass:\"list-group\",attrs:{\"tag\":\"ul\",\"move\":_vm.onItemMoved},on:{\"start\":function($event){_vm.dragging = true},\"end\":function($event){_vm.dragging = false},\"change\":_vm.onOrderChanged},model:{value:(_vm.items),callback:function ($$v) {_vm.items=$$v},expression:\"items\"}},'draggable',_vm.dragOptions,false),[_c('transition-group',{staticClass:\"d-flex flex-wrap\",attrs:{\"type\":\"transition\",\"name\":\"flip-list\"}},_vm._l((_vm.items),function(item){return _c('li',{key:item.id,staticClass:\"list-group-item daily-bonus-page__item\"},[_c('daily-bonus-item',{ref:\"dailyBonusItems\",refInFor:true,attrs:{\"initial-data\":item},on:{\"changed\":_vm.onItemSettingsChanged,\"deleted\":_vm.onDeleteItem}})],1)}),0)],1),_c('ui-button',{staticClass:\"float-left mt-3\",attrs:{\"color\":\"blue\"},on:{\"clicked\":_vm.onAddDayClick}},[_vm._v(\" Добавить день \")])],1)]:_vm._e()],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"page daily-bonus-page\">\r\n        <div class=\"page__title\">\r\n            <nav-back/>\r\n            Ежедневный бонус\r\n            <ui-button color=\"blue\" class=\"page__title-button\" @clicked=\"onSaveClick\" :disabled=\"!anyChanges\">\r\n                Сохранить\r\n            </ui-button>\r\n        </div>\r\n        <template v-if=\"pageIsReady\">\r\n            <div class=\"daily-bonus-page__status\">\r\n                <label class=\"my-0\">Статус:</label>\r\n                <b-dropdown :text=\"statusText\">\r\n                    <b-dropdown-item v-for=\"(status, i) of statusOptions\" :key=\"i\" @click=\"onStatusSelect\"\r\n                                     :data-value=\"status.value\">\r\n                        {{ status.name }}\r\n                    </b-dropdown-item>\r\n                </b-dropdown>\r\n            </div>\r\n            <div  class=\"daily-bonus-page__items-list\">\r\n                <draggable\r\n                    class=\"list-group\"\r\n                    tag=\"ul\"\r\n                    v-model=\"items\"\r\n                    v-bind=\"dragOptions\"\r\n                    @start=\"dragging = true\"\r\n                    @end=\"dragging = false\"\r\n                    @change=\"onOrderChanged\"\r\n                    :move=\"onItemMoved\"\r\n                >\r\n                    <transition-group type=\"transition\" name=\"flip-list\" class=\"d-flex flex-wrap\">\r\n                        <li\r\n                            class=\"list-group-item daily-bonus-page__item\"\r\n                            v-for=\"item of items\"\r\n                            :key=\"item.id\"\r\n                        >\r\n                            <daily-bonus-item v-bind:initial-data=\"item\"\r\n                                              ref=\"dailyBonusItems\"\r\n                                              @changed=\"onItemSettingsChanged\"\r\n                                              @deleted=\"onDeleteItem\"\r\n                            />\r\n                        </li>\r\n                    </transition-group>\r\n                </draggable>\r\n                <ui-button color=\"blue\" class=\"float-left mt-3\" @clicked=\"onAddDayClick\">\r\n                    Добавить день\r\n                </ui-button>\r\n            </div>\r\n        </template>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport draggable from \"vuedraggable\";\r\nimport {mapActions} from 'vuex';\r\nimport bus from '@/plugins/bus';\r\n\r\nexport default {\r\n    data: () => ({\r\n        pageIsReady: false,\r\n        anyChanges: false,\r\n        items: [],\r\n        dragging: false,\r\n        dragLocked: false,\r\n\r\n        statusText: '',\r\n        statusOption: 1,\r\n        statusOptions: [\r\n            {value: 1, name: 'Включено'},\r\n            {value: 0, name: 'Выключено'},\r\n        ]\r\n    }),\r\n    components: {\r\n        draggable,\r\n        UiButton: () => import('../../components/ui/UiButton'),\r\n        NavBack: () => import('../../components/navigation/NavBack'),\r\n        DailyBonusItem: () => import('../../components/dailyBonus/DailyBonusItem')\r\n    },\r\n    computed: {\r\n        dragOptions() {\r\n            return {\r\n                animation: 0,\r\n                group: 'description',\r\n                disabled: false,\r\n                ghostClass: 'ghost',\r\n                direction: 'vertical'\r\n            };\r\n        },\r\n    },\r\n    async created() {\r\n        await this.getConfig();\r\n        this.statusOption = this.$store.state.firebase.config.DailyBonuses.is_enabled ? 1 : 0;\r\n        this.statusText = this.statusOptions.find(status => status.value === this.statusOption).name;\r\n        this.items = this.$store.state.firebase.config.DailyBonuses.bonuses;\r\n        this.pageIsReady = true;\r\n    },\r\n    methods: {\r\n        ...mapActions('firebase', ['getConfig', 'updateDailyBonusesConfig']),\r\n        onOrderChanged() {\r\n            this.items.forEach((item, i) => {\r\n                item.id = i + 1;\r\n                this.$refs.dailyBonusItems[i].setData(item);\r\n            });\r\n            this.anyChanges = true;\r\n        },\r\n        onItemMoved() {\r\n            return !this.dragLocked;\r\n        },\r\n        onItemSettingsChanged(id, property, value) {\r\n            const item = this.items.find(item => item.id === id);\r\n            if (!item || !item.hasOwnProperty(property)) return;\r\n            item[property] = value;\r\n            this.anyChanges = true;\r\n        },\r\n        async onSaveClick() {\r\n            if (!this.anyChanges) return;\r\n\r\n            const bonuses = [];\r\n            for (let i = 0; i < this.$refs.dailyBonusItems.length; i++)\r\n                bonuses.push(this.$refs.dailyBonusItems[i].getData());\r\n\r\n            const response = await this.updateDailyBonusesConfig({\r\n                is_enabled: this.statusOption === 1,\r\n                bonuses\r\n            });\r\n\r\n            if (!response.error)\r\n                bus.$emit('show-notification-message', 'Сохранено');\r\n            else\r\n                bus.$emit('show-notification-message', `Ошибка: ${response.error.toString()}`);\r\n\r\n            this.anyChanges = false;\r\n        },\r\n        onAddDayClick() {\r\n            this.items.push({\r\n                id: this.items.length + 1,\r\n                available: true,\r\n                is_completed: false,\r\n                ads_bonus: 0,\r\n                reward: {id: 1, value: 0},\r\n                vip_reward: {id: 1, value: 0},\r\n            });\r\n            this.anyChanges = true;\r\n        },\r\n        onDeleteItem(day) {\r\n            if (!confirm(`Вы точно хотите удалить День #${day}?`)) return;\r\n            this.items.splice(day - 1, 1);\r\n            this.items.forEach((item, i) => {\r\n                item.id = i + 1;\r\n                this.$refs.dailyBonusItems[i].setData(item);\r\n            });\r\n            this.anyChanges = true;\r\n        },\r\n        onStatusSelect(event) {\r\n            this.statusOption = parseInt(event.target.dataset.value, 10);\r\n            this.statusText = this.statusOptions.find(status => status.value === this.statusOption).name;\r\n            this.anyChanges = true;\r\n        }\r\n    }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.daily-bonus-page {\r\n    &__items-list {\r\n        .list-group {\r\n            flex-direction: column;\r\n        }\r\n    }\r\n\r\n    &__item {\r\n        width: 100%;\r\n        border: 1px solid rgb(84 84 84 / 22%) !important;\r\n        border-radius: 8px !important;\r\n        margin: 4px 0;\r\n    }\r\n\r\n    &__status {\r\n        display: grid;\r\n        grid-template-columns: 72px 100px;\r\n        align-items: center;\r\n        margin-bottom: 8px;\r\n        text-align: left;\r\n    }\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DailyBonus.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DailyBonus.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DailyBonus.vue?vue&type=template&id=5df0810a&\"\nimport script from \"./DailyBonus.vue?vue&type=script&lang=js&\"\nexport * from \"./DailyBonus.vue?vue&type=script&lang=js&\"\nimport style0 from \"./DailyBonus.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DailyBonus.vue?vue&type=style&index=0&lang=scss&\""],"sourceRoot":""}