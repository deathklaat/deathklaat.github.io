(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["products"],{"14b9":function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var r=a("bc87"),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"modal-popup"},[a("div",{staticClass:"mb-3 modal-popup__title"},[e._v(" Добавление пака "),a("svg",{staticClass:"bi bi-x-lg modal-popup__close",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"#2D4C70",viewBox:"0 0 16 16"},on:{click:e.close}},[a("path",{attrs:{d:"M1.293 1.293a1 1 0 0 1 1.414 0L8 6.586l5.293-5.293a1 1 0 1 1 1.414 1.414L9.414 8l5.293 5.293a1 1 0 0 1-1.414 1.414L8 9.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L6.586 8 1.293 2.707a1 1 0 0 1 0-1.414z"}})])]),a("div",{staticClass:"input-group"},[a("label",{staticClass:"modal-popup__label text-left",staticStyle:{width:"100%"}},[e._v("Google ID")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.googleID,expression:"googleID"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:e.googleID},on:{input:function(t){t.target.composing||(e.googleID=t.target.value)}}})]),a("div",{staticClass:"input-group mb-3"},[a("label",{staticClass:"modal-popup__label text-left",staticStyle:{width:"100%"}},[e._v("Apple ID")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.appleID,expression:"appleID"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:e.appleID},on:{input:function(t){t.target.composing||(e.appleID=t.target.value)}}})]),a("div",{staticClass:"input-group mb-3"},[a("label",{staticClass:"modal-popup__label text-left",staticStyle:{width:"100%"}},[e._v("Бонус первой покупки %")]),a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.firstBonus,expression:"firstBonus",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"0",oninput:"validity.valid||(value=0)"},domProps:{value:e.firstBonus},on:{input:function(t){t.target.composing||(e.firstBonus=e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})]),e._l(e.rewards,(function(t,r){return a("div",{staticClass:"input-group mb-3 align-items-center"},[a("b-form-select",{staticClass:"form-control",attrs:{options:e.currenciesOptions},model:{value:e.selectedCurrencies[r],callback:function(t){e.$set(e.selectedCurrencies,r,t)},expression:"selectedCurrencies[i]"}}),a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.rewards[r].value,expression:"rewards[i].value",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"1",oninput:"validity.valid||(value=0)"},domProps:{value:e.rewards[r].value},on:{input:function(t){t.target.composing||e.$set(e.rewards[r],"value",e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}}),a("svg",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"bi bi-trash ms-3 ml-2",staticStyle:{cursor:"pointer"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",viewBox:"0 0 16 16",title:"Удалить"},on:{click:function(t){return e.onDeleteRewardClick(r)}}},[a("path",{attrs:{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"}}),a("path",{attrs:{"fill-rule":"evenodd",d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"}})])],1)})),a("div",{staticClass:"d-flex justify-content-center",staticStyle:{width:"100%"}},[a("ui-button",{staticClass:"mt-3 mb-2 d-flex",staticStyle:{width:"200px"},on:{clicked:e.onAddRewardClick}},[e._v(" Добавить валюту ")])],1),a("div",{staticClass:"d-flex justify-content-center",staticStyle:{width:"100%"}},[a("ui-button",{staticClass:"mt-3 mb-2",staticStyle:{width:"200px"},on:{clicked:e.onSaveClick}},[e._v("Сохранить")])],1),e.alert.length?a("div",{staticClass:"alert alert-danger",attrs:{role:"alert"}},[e._v(e._s(e.alert))]):e._e()],2)},n=[],i=a("53ca"),o=a("1da1"),c=a("5530"),l=(a("96cf"),a("d3b7"),a("3ca3"),a("ddb0"),a("d81d"),a("4de4"),a("b0c0"),a("7db0"),a("a434"),a("2f62")),u=a("a70a"),d={data:function(){return{alert:"",canReset:!1,currenciesOptions:[],selectedCurrencies:[],rewards:[],googleID:"",appleID:"",firstBonus:0}},computed:Object(c["a"])(Object(c["a"])({},Object(l["c"])("firebase",["getNewProductID"])),{},{currencies:function(){return this.$store.state.firebase.config.Currencies}}),components:{UiButton:function(){return a.e("chunk-7a628425").then(a.bind(null,"832a"))}},mounted:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getConfig();case 2:case"end":return t.stop()}}),t)})))()},methods:Object(c["a"])(Object(c["a"])({},Object(l["b"])("firebase",["getConfig","saveProduct"])),{},{resetAlert:function(){this.canReset&&(this.alert="",this.canReset=!1)},setAlert:function(e){var t=this;this.alert=e,setTimeout((function(e){return t.canReset=!0}),250)},fillSelects:function(){this.currenciesOptions=this.currencies.filter((function(e){return e.id>0})).map((function(e){return{value:e.id,text:e.name}}))},onSaveClick:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,r,s,n,o,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.googleID.length){t.next=3;break}return e.setAlert("Необходимо указать Google ID товара"),t.abrupt("return");case 3:if(e.appleID.length){t.next=6;break}return e.setAlert("Необходимо указать Apple ID товара"),t.abrupt("return");case 6:if(e.rewards.length){t.next=9;break}return e.setAlert("Необходимо задать хотя бы 1 валюту"),t.abrupt("return");case 9:a={},r=[],s=function(t){if(!e.rewards[t].value)return e.setAlert("Не должно быть нулевых значений валют"),{v:void 0};if(a[e.selectedCurrencies[t]]){var s=e.currencies.find((function(a){return a.id===e.selectedCurrencies[t]}));return e.setAlert("Найдены дубликаты наград: ".concat(s.name)),{v:void 0}}a[e.selectedCurrencies[t]]=1,r.push({id:e.selectedCurrencies[t],value:e.rewards[t].value})},n=0;case 13:if(!(n<e.rewards.length)){t.next=20;break}if(o=s(n),"object"!==Object(i["a"])(o)){t.next=17;break}return t.abrupt("return",o.v);case 17:n++,t.next=13;break;case 20:return t.next=22,e.saveProduct({id:e.getNewProductID,google_id:e.googleID,apple_id:e.appleID,first_bonus:e.firstBonus,rewards:r});case 22:c=t.sent,c.error?e.setAlert("Ошибка добавления"):(c.rewards.length>1&&u["a"].$emit("products-list-updated",c),e.close());case 24:case"end":return t.stop()}}),t)})))()},onAddRewardClick:function(){this.rewards.push({id:1,value:1}),this.selectedCurrencies.push(1),this.fillSelects()},close:function(){this.$modal.hide("add-multi-pack-modal")},onDeleteRewardClick:function(e){this.rewards.splice(e,1),this.selectedCurrencies.splice(e,1),this.fillSelects()}})},p=d,f=(a("3c6e"),a("2877")),h=Object(f["a"])(p,s,n,!1,null,null,null),m=h.exports,v=function(){var e=new r["a"]({component:m,props:{},params:{transition:"scale",name:"add-multi-pack-modal",width:"100%",height:"100%",classes:"modal-popup__overlay"}});e.show()}},"1de0":function(e,t,a){"use strict";a("e494")},"29b4":function(e,t,a){},"3c6e":function(e,t,a){"use strict";a("e6ea")},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,a){var r=a("1d80"),s=a("5899"),n="["+s+"]",i=RegExp("^"+n+n+"*"),o=RegExp(n+n+"*$"),c=function(e){return function(t){var a=String(r(t));return 1&e&&(a=a.replace(i,"")),2&e&&(a=a.replace(o,"")),a}};e.exports={start:c(1),end:c(2),trim:c(3)}},a551:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.pageIsReady?a("div",{staticClass:"page products-page"},[a("div",{staticClass:"page__title"},[a("nav-back"),e._v(" Список товаров "),a("ui-button",{staticStyle:{position:"absolute",right:"0"},on:{clicked:e.onSortingButtonClick}},[e._v("Сортировка")])],1),a("h1",[e._v("Мульти-паки")]),e.pageIsReady?a("multi-packs-list",{attrs:{packs:e.multiPacksList}}):e._e(),a("h1",[e._v("Одиночные паки")]),e._l(Object.keys(e.singlePacksList),(function(t){return e.pageIsReady?a("packs-list",e._b({key:t,attrs:{packs:e.singlePacksList[t]}},"packs-list",e.getCurrencyData(parseInt(t,10)),!1)):e._e()})),Object.keys(e.singlePacksList).length?e._e():[a("ui-button",{staticClass:"products-page__add-single-pack-button",on:{clicked:e.onAddSinglePackClick}},[e._v(" Добавить товар ")])]],2):e._e()},s=[],n=a("1da1"),i=a("5530"),o=(a("96cf"),a("d3b7"),a("3ca3"),a("ddb0"),a("4de4"),a("2f62")),c=a("bc87"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"modal-popup",on:{click:e.resetAlert,keyup:function(t){return t.type.indexOf("key")||13===t.keyCode?e.onSaveClick.apply(null,arguments):null}}},[a("div",{staticClass:"mb-3 modal-popup__title"},[e._v(" Порядок вывода товаров "),a("svg",{staticClass:"bi bi-x-lg modal-popup__close",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"#2D4C70",viewBox:"0 0 16 16"},on:{click:e.close}},[a("path",{attrs:{d:"M1.293 1.293a1 1 0 0 1 1.414 0L8 6.586l5.293-5.293a1 1 0 1 1 1.414 1.414L9.414 8l5.293 5.293a1 1 0 0 1-1.414 1.414L8 9.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L6.586 8 1.293 2.707a1 1 0 0 1 0-1.414z"}})])]),e.popupIsReady?a("div",{staticClass:"products-sorting-modal__selects-group"},e._l(e.productsList,(function(t,r){return a("b-form-select",{key:r,staticClass:"form-control",attrs:{options:e.productsOptions},model:{value:e.productsList[r],callback:function(t){e.$set(e.productsList,r,t)},expression:"productsList[i]"}})})),1):e._e(),a("ui-button",{staticClass:"mb-2",on:{clicked:e.onSaveClick}},[e._v("Сохранить")]),e.alert.length?a("div",{class:["alert",e.alertClass],attrs:{role:"alert"}},[e._v(e._s(e.alert))]):e._e()],1)},u=[],d=a("53ca"),p=(a("d81d"),a("07ac"),a("7db0"),{data:function(){return{alert:"",alertClass:"",canReset:!1,productsOptions:[],productsList:[],popupIsReady:!1}},components:{UiButton:function(){return a.e("chunk-7a628425").then(a.bind(null,"832a"))}},computed:{products:function(){return this.$store.state.firebase.config.Products.products}},created:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getConfig();case 2:e.fillSelects();case 3:case"end":return t.stop()}}),t)})))()},methods:Object(i["a"])(Object(i["a"])({},Object(o["b"])("firebase",["getConfig","updateProductsOrder"])),{},{close:function(){this.$modal.hide("products-sorting-modal")},fillSelects:function(){this.productsOptions=Object.values(this.products).map((function(e){return{text:e.google_id,value:e.id}}));for(var e=0;e<this.productsOptions.length;e++)this.productsList[e]=this.productsOptions[e].value;this.popupIsReady=!0},resetAlert:function(){this.canReset&&(this.alert="",this.canReset=!1)},setAlert:function(e){var t=this,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.alert=e,this.alertClass=a?"alert-danger":"alert-success",setTimeout((function(){t.canReset=!0}),250)},onSaveClick:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,r,s,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a={},r=function(t){if(a[e.productsList[t]]){var r=e.products.find((function(a){return a.id===e.productsList[t]}));return e.setAlert("Найден дубликат товара: ".concat(r.google_id)),{v:void 0}}a[e.productsList[t]]=1},s=0;case 3:if(!(s<e.productsList.length)){t.next=10;break}if(n=r(s),"object"!==Object(d["a"])(n)){t.next=7;break}return t.abrupt("return",n.v);case 7:s++,t.next=3;break;case 10:return t.next=12,e.updateProductsOrder(e.productsList);case 12:i=t.sent,i.error?e.setAlert("Ошибка обновления"):e.setAlert("Успешно сохранено",!1);case 14:case"end":return t.stop()}}),t)})))()}})}),f=p,h=(a("ef98"),a("2877")),m=Object(h["a"])(f,l,u,!1,null,null,null),v=m.exports,g=function(e){var t=new c["a"]({component:v,params:{transition:"scale",name:"products-sorting-modal",width:"100%",height:"100%",classes:"modal-popup__overlay"}});t.show()},b=a("14b9"),_=a("a70a"),y={data:function(){return{pageIsReady:!1}},components:{NavBack:function(){return a.e("chunk-49c533a1").then(a.bind(null,"e019"))},UiButton:function(){return a.e("chunk-7a628425").then(a.bind(null,"832a"))},PacksList:function(){return a.e("chunk-ed43a738").then(a.bind(null,"cf4a"))},MultiPacksList:function(){return a.e("chunk-271b4faa").then(a.bind(null,"48a3"))}},computed:Object(i["a"])(Object(i["a"])({},Object(o["c"])("firebase",["getCurrencyById","getMultiProductsList","getSingleProductsList"])),{},{currencies:function(){return this.$store.state.firebase.config.Currencies.filter((function(e){return 0!==e.id}))},singlePacksList:function(){return this.getSingleProductsList},multiPacksList:function(){return this.getMultiProductsList}}),created:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getConfig();case 2:_["a"].$off("products-list-updated").$on("products-list-updated",e.onProductsUpdated),e.pageIsReady=!0;case 4:case"end":return t.stop()}}),t)})))()},beforeDestroy:function(){_["a"].$off("products-list-updated",this.onProductsUpdated)},methods:Object(i["a"])(Object(i["a"])({},Object(o["b"])("firebase",["getConfig"])),{},{onSortingButtonClick:function(){g()},onProductsUpdated:function(){this.$forceUpdate()},onAddSinglePackClick:function(){Object(b["a"])()},getCurrencyData:function(e){return this.getCurrencyById(e)}})},C=y,k=(a("d49d"),Object(h["a"])(C,r,s,!1,null,null,null));t["default"]=k.exports},a9e3:function(e,t,a){"use strict";var r=a("83ab"),s=a("da84"),n=a("94ca"),i=a("6eeb"),o=a("5135"),c=a("c6b6"),l=a("7156"),u=a("c04e"),d=a("d039"),p=a("7c73"),f=a("241c").f,h=a("06cf").f,m=a("9bf2").f,v=a("58a8").trim,g="Number",b=s[g],_=b.prototype,y=c(p(_))==g,C=function(e){var t,a,r,s,n,i,o,c,l=u(e,!1);if("string"==typeof l&&l.length>2)if(l=v(l),t=l.charCodeAt(0),43===t||45===t){if(a=l.charCodeAt(2),88===a||120===a)return NaN}else if(48===t){switch(l.charCodeAt(1)){case 66:case 98:r=2,s=49;break;case 79:case 111:r=8,s=55;break;default:return+l}for(n=l.slice(2),i=n.length,o=0;o<i;o++)if(c=n.charCodeAt(o),c<48||c>s)return NaN;return parseInt(n,r)}return+l};if(n(g,!b(" 0o1")||!b("0b1")||b("+0x1"))){for(var k,w=function(e){var t=arguments.length<1?0:e,a=this;return a instanceof w&&(y?d((function(){_.valueOf.call(a)})):c(a)!=g)?l(new b(C(t)),a,w):C(t)},x=r?f(b):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),D=0;x.length>D;D++)o(b,k=x[D])&&!o(w,k)&&m(w,k,h(b,k));w.prototype=_,_.constructor=w,i(s,g,w)}},aa48:function(e,t,a){},bc87:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var r=a("d4ec"),s=a("bee2"),n=(a("b0c0"),a("1881")),i=a.n(n),o=function(){function e(t){var a=t.component,s=t.props,n=void 0===s?{}:s,i=t.params,o=void 0===i?{}:i,c=t.events,l=void 0===c?{}:c;Object(r["a"])(this,e),this.component=a,this.props=n,this.params=o,this.events={opened:function(){Object.assign(a,{modalName:o.name})},closed:function(){}},Object.assign(this.events,l)}return Object(s["a"])(e,[{key:"show",value:function(){i.a.rootInstance.$modal.show(this.component,this.props,this.params,this.events)}},{key:"hide",value:function(){i.a.rootInstance.$emit("close")}}]),e}()},c487:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page players-page",on:{keyup:function(t){return t.type.indexOf("key")||13===t.keyCode?e.findPlayer.apply(null,arguments):null}}},[a("div",{staticClass:"page__title"},[a("nav-back"),e._v(" "+e._s(e.playerData?"Данные по игроку #"+e.playerData.id:"Поиск игрока")+" "),a("div",{staticStyle:{position:"absolute",right:"0"}},[e.playerData?a("ui-button",{staticClass:"players-page__reset-button mr-2",on:{clicked:e.onSetChapterClick}},[e._v(" Выставить прогресс ")]):e._e(),e.playerData?a("ui-button",{staticClass:"players-page__reset-button",on:{clicked:e.onResetPlayerClick}},[e._v(" Обнулить игрока ")]):e._e(),e.playerData?a("ui-button",{staticClass:"players-page__reset-button ml-2",on:{clicked:function(t){e.playerData=null}}},[e._v(" Поиск ")]):e._e()],1)],1),e.playerData?[a("div",{staticClass:"mb-3"},[a("div",{staticClass:"players-page__field-title"},[e._v(" Тестировщик "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.playerData.is_tester,expression:"playerData.is_tester"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.playerData.is_tester)?e._i(e.playerData.is_tester,null)>-1:e.playerData.is_tester},on:{change:[function(t){var a=e.playerData.is_tester,r=t.target,s=!!r.checked;if(Array.isArray(a)){var n=null,i=e._i(a,n);r.checked?i<0&&e.$set(e.playerData,"is_tester",a.concat([n])):i>-1&&e.$set(e.playerData,"is_tester",a.slice(0,i).concat(a.slice(i+1)))}else e.$set(e.playerData,"is_tester",s)},function(t){return e.onTesterFlagChanged(t)}]}})])]),a("div",{staticClass:"mb-3"},[a("div",{staticClass:"players-page__field-title"},[e._v("Дата регистрации: "+e._s(e.registrationDate))])]),a("div",{staticClass:"mb-3"},[a("div",{staticClass:"players-page__field-title"},[e._v(" Контент для взрослых: "+e._s(e.playerData.adult?"разрешен":"отклонен")+" ")])]),a("div",{staticClass:"mb-3"},[a("div",{staticClass:"players-page__field-title mb-3"},[e._v(" Баланс "),a("ui-button",{staticClass:"ml-5",on:{clicked:e.setUserCurrency}},[e._v("Обновить")])],1),a("div",{staticClass:"players-page__list"},e._l(e.playerData.monies,(function(t,r){return a("div",{staticClass:"players-page__list-row"},[a("div",{staticClass:"text-left font-weight-bold"},[e._v(e._s(e.getCurrencyName(t.id))+":")]),a("div",[a("input",{directives:[{name:"model",rawName:"v-model.number",value:t.value,expression:"money.value",modifiers:{number:!0}}],staticClass:"form-control",attrs:{min:"0",oninput:"validity.valid||(value=0)"},domProps:{value:t.value},on:{input:function(a){a.target.composing||e.$set(t,"value",e._n(a.target.value))},blur:function(t){return e.$forceUpdate()}}})])])})),0)]),e.recommendedStoryData?a("div",{staticClass:"mb-3"},[a("div",{staticClass:"players-page__field-title"},[e._v(" Рекомендовано к чтению: "),a("a",{attrs:{href:"/story/"+e.recommendedStoryData.id,target:"_blank"}},[e._v(" #"+e._s(e.recommendedStoryData.id)+" "+e._s(e.recommendedStoryData.title)+" ")])])]):e._e(),e.activeStoryData?a("div",{staticClass:"mb-3"},[a("div",{staticClass:"players-page__field-title"},[e._v(" Сейчас читает: "),a("a",{attrs:{href:"/story/"+e.activeStoryData.id,target:"_blank"}},[e._v(" #"+e._s(e.activeStoryData.id)+" "+e._s(e.activeStoryData.title)+" ")]),e._v(" - "),a("a",{attrs:{href:"/chapter/"+e.playerData.last_chapter.id,target:"_blank"}},[e._v(" Глава "+e._s(e.activeStoryChapterNumber)+" ")])])]):e._e(),a("div",{staticClass:"mb-3"},[a("div",{staticClass:"players-page__field-title mb-3"},[e._v("Начатые книги")]),a("div",{staticClass:"players-page__list"},[a("table",{staticClass:"table table-striped"},[e._m(0),a("tbody",e._l(e.startedStories,(function(t,r){return a("tr",{key:r},[a("td",[e._v(e._s(t.id))]),a("td",[a("a",{attrs:{href:"/story/"+t.id,target:"_blank"}},[e._v(e._s(t.title))])]),a("td",[e._v(e._s(t.completedChapters))])])})),0)])])]),a("div",{staticClass:"mb-3"},[a("div",{staticClass:"players-page__field-title mb-3"},[e._v("Социальные сети")]),a("div",{staticClass:"players-page__list"},[a("table",{staticClass:"table table-striped text-left"},[e._m(1),a("tbody",e._l(e.socialMap,(function(t){return a("tr",{key:t},[a("td",{staticStyle:{width:"20%"}},[e._v(e._s(t))]),a("td",{staticStyle:{"user-select":"text"}},[e._v(" "+e._s(e.playerData.profile_type===t?e.getSocialLink(t,e.playerData.profile_id):"-")+" ")])])})),0)])])])]:[a("div",{staticClass:"form-group players-page__search-block"},[a("label",{staticClass:"players-page__label"},[e._v("Соц. сеть")]),a("b-form-select",{staticClass:"players-page__find-value",attrs:{options:e.socialOptions},model:{value:e.selectedSocialOption,callback:function(t){e.selectedSocialOption=t},expression:"selectedSocialOption"}})],1),a("div",{staticClass:"form-group players-page__search-block"},[a("label",{staticClass:"players-page__label"},[e._v("ID")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.socialId,expression:"socialId"}],staticClass:"form-control players-page__find-value",attrs:{type:"text"},domProps:{value:e.socialId},on:{input:function(t){t.target.composing||(e.socialId=t.target.value)}}})]),a("ui-button",{staticClass:"players-page__find-button",on:{clicked:e.findPlayer}},[e._v("Найти")])]],2)},s=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("thead",[a("tr",[a("th",{attrs:{scope:"col"}},[e._v("ID")]),a("th",{attrs:{scope:"col"}},[e._v("Название")]),a("th",{attrs:{scope:"col"}},[e._v("Завершено глав")])])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("thead",[a("tr",[a("th",{attrs:{scope:"col"}},[e._v("Соц. сеть")]),a("th",{attrs:{scope:"col"}},[e._v("ID")])])])}],n=a("5530"),i=a("1da1"),o=(a("96cf"),a("ac1f"),a("1276"),a("159b"),a("7db0"),a("d3b7"),a("3ca3"),a("ddb0"),a("d81d"),a("25f0"),a("b0c0"),a("a70a")),c=a("2f62"),l=a("bc87"),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"modal-popup",on:{click:e.resetAlert,keyup:function(t){return t.type.indexOf("key")||13===t.keyCode?e.onSaveClick.apply(null,arguments):null}}},[a("div",{staticClass:"mb-3 modal-popup__title"},[e._v(" Выставить прогресс "),a("svg",{staticClass:"bi bi-x-lg modal-popup__close",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"#2D4C70",viewBox:"0 0 16 16"},on:{click:e.close}},[a("path",{attrs:{d:"M1.293 1.293a1 1 0 0 1 1.414 0L8 6.586l5.293-5.293a1 1 0 1 1 1.414 1.414L9.414 8l5.293 5.293a1 1 0 0 1-1.414 1.414L8 9.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L6.586 8 1.293 2.707a1 1 0 0 1 0-1.414z"}})])]),e.progressData.length>0&&e.pageIsReady?[a("div",{staticClass:"form-group d-flex flex-column"},[a("label",{staticClass:"text-left"},[e._v("ID истории")]),a("b-form-select",{staticClass:"players-page__find-value",attrs:{options:e.storiesOptions},model:{value:e.selectedStoryId,callback:function(t){e.selectedStoryId=t},expression:"selectedStoryId"}})],1),a("div",{staticClass:"form-group d-flex flex-column"},[a("label",{staticClass:"text-left"},[e._v("ID главы")]),a("b-form-select",{staticClass:"players-page__find-value",attrs:{options:e.chapterOptions},model:{value:e.selectedChapterId,callback:function(t){e.selectedChapterId=t},expression:"selectedChapterId"}})],1),a("div",{staticClass:"form-group d-flex flex-column"},[a("label",{staticClass:"text-left"},[e._v("ID ноды")]),a("b-form-select",{staticClass:"players-page__find-value",attrs:{options:e.nodeOptions},model:{value:e.selectedProgressId,callback:function(t){e.selectedProgressId=t},expression:"selectedProgressId"}})],1),a("div",{staticClass:"form-group text-left mt-2 ml-1"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.needToResetChapter,expression:"needToResetChapter"}],staticClass:"mr-2",attrs:{type:"checkbox",id:"needToResetChapter"},domProps:{checked:Array.isArray(e.needToResetChapter)?e._i(e.needToResetChapter,null)>-1:e.needToResetChapter},on:{change:function(t){var a=e.needToResetChapter,r=t.target,s=!!r.checked;if(Array.isArray(a)){var n=null,i=e._i(a,n);r.checked?i<0&&(e.needToResetChapter=a.concat([n])):i>-1&&(e.needToResetChapter=a.slice(0,i).concat(a.slice(i+1)))}else e.needToResetChapter=s}}}),a("label",{attrs:{for:"needToResetChapter"}},[e._v("Сбросить прогресс главы")])]),a("ui-button",{staticClass:"mt-0 mb-2",attrs:{disabled:e.pendingRequest},on:{clicked:e.onSaveClick}},[e._v("Сохранить")])]:[a("div",{staticClass:"mb-2"},[e._v("У пользователя нет историй с прогрессом")])],e.alert.length?a("div",{staticClass:"alert alert-danger",attrs:{role:"alert"}},[e._v(e._s(e.alert))]):e._e()],2)},d=[],p=(a("a9e3"),a("4de4"),a("caad"),a("2532"),{props:["playerId","progressData"],data:function(){return{storyId:Number,chapterId:Number,nodeId:Number,needToResetChapter:!1,alert:"",canReset:!1,pendingRequest:!1,pageIsReady:!1,selectedStoryId:0,storiesOptions:[],selectedChapterId:0,chapterOptions:[],selectedProgressId:0,nodeOptions:[],storyProgressData:{},selectedChapterData:{},availableChapters:[],storyData:{}}},components:{UiButton:function(){return a.e("chunk-7a628425").then(a.bind(null,"832a"))}},mounted:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$refs.firstInput&&e.$refs.firstInput.focus(),e.progressData.length){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,e.getConfig();case 5:e.fillSelects();case 6:case"end":return t.stop()}}),t)})))()},watch:{selectedStoryId:function(e){var t=this;this.storyProgressData=this.progressData.find((function(t){return t.story_id==e})),this.availableChapters=this.storyProgressData.chapters.map((function(e){return e.chapters_id})),this.storyData=this.$store.state.stories.list.find((function(t){return t.id==e})),this.chapterOptions=this.storyData.chapters.filter((function(e){return t.availableChapters.includes(e.id)})).map((function(e){return{text:e.title,value:e.id}})),this.selectedChapterId=this.chapterOptions[0].value},selectedChapterId:function(e){this.selectedChapterData=this.storyProgressData.chapters.find((function(t){return t.chapters_id==e})),this.nodeOptions=this.selectedChapterData.nodes.map((function(e){return{text:e.node,value:e.progress_id}})),this.selectedProgressId=this.nodeOptions[0].value}},methods:Object(n["a"])(Object(n["a"])(Object(n["a"])({},Object(c["b"])("players",["setUserProgress"])),Object(c["b"])("firebase",["getConfig"])),{},{fillSelects:function(){var e=this.progressData.map((function(e){return e.story_id}));this.storiesOptions=this.$store.state.stories.list.filter((function(t){return e.includes(t.id)})).map((function(e){return{value:e.id,text:e.title}})),this.selectedStoryId=this.storiesOptions[0].value,this.pageIsReady=!0},resetAlert:function(){this.canReset&&(this.alert="",this.canReset=!1)},setAlert:function(e){var t=this;this.alert=e,setTimeout((function(){t.canReset=!0}),250)},onSaveClick:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={story_id:e.selectedStoryId,chapter_id:e.selectedChapterId,progress_id:e.needToResetChapter?null:e.selectedProgressId,is_reset:e.needToResetChapter},e.pendingRequest=!0,t.next=4,e.setUserProgress({playerId:e.playerId,postData:a});case 4:r=t.sent,e.pendingRequest=!1,r.error?o["a"].$emit("show-notification-message","Ошибка: ".concat(r.error.toString())):(o["a"].$emit("show-notification-message","Обновлено"),e.close());case 7:case"end":return t.stop()}}),t)})))()},close:function(){this.$modal.hide("set-user-chapter-modal")},onStorySelected:function(e){var t=this;this.selectedStoryId=parseInt(e.target.dataset.value,10),this.selectedStoryName=this.storiesOptions.find((function(e){return e.id==t.selectedStoryId})).name}})}),f=p,h=a("2877"),m=Object(h["a"])(f,u,d,!1,null,null,null),v=m.exports,g=function(e,t){var a=new l["a"]({component:v,props:{playerId:e,progressData:t},params:{transition:"scale",name:"set-user-chapter-modal",width:"100%",height:"100%",classes:"modal-popup__overlay"}});a.show()},b={data:function(){return{pageReady:!1,playerData:null,socialMap:["local","facebook","google","apple"],socialOptions:[],selectedSocialOption:0,socialId:"",progressData:[]}},computed:{registrationDate:function(){return this.playerData?this.playerData.created_at.split("T")[0]:""},startedStories:function(){var e=this;if(!this.pageReady)return[];var t=[];return this.playerData.started_stories.forEach((function(a){for(var r=e.$store.state.stories.list.find((function(e){return e.id===a.story_id})),s=0,n=0;n<r.chapters.length;n++)if(r.chapters[n].id===a.chapter_id){s=n;break}t.push({id:r.id,title:r.title,completedChapters:s})})),t},activeStoryData:function(){var e=this;return!!this.playerData.last_chapter.id&&this.$store.state.stories.list.find((function(t){return t.id===e.playerData.last_chapter.story.id}))},recommendedStoryData:function(){var e=this;if(null!=this.playerData.last_chapter.id||!this.playerData.recommended_story_id)return!1;var t=this.$store.state.stories.list.find((function(t){return t.id===e.playerData.recommended_story_id}));return t||{id:this.playerData.recommended_story_id,title:"Ошибка: история не найдена"}},activeStoryChapterNumber:function(){if(!this.activeStoryData)return 0;for(var e=0;e<this.activeStoryData.chapters.length;e++)if(this.activeStoryData.chapters[e].id===this.playerData.last_chapter.id)return e+1;return 0}},components:{UiButton:function(){return a.e("chunk-7a628425").then(a.bind(null,"832a"))},NavBack:function(){return a.e("chunk-49c533a1").then(a.bind(null,"e019"))}},created:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getConfig();case 2:e.socialOptions=e.socialMap.map((function(e,t){return{text:e,value:t}})),e.pageReady=!0;case 4:case"end":return t.stop()}}),t)})))()},methods:Object(n["a"])(Object(n["a"])(Object(n["a"])({},Object(c["b"])("players",["getPlayer","resetPlayer","setTesterFlag","getUserProgress"])),Object(c["b"])("firebase",["getConfig"])),{},{findPlayer:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.playerData){t.next=2;break}return t.abrupt("return");case 2:if(e.socialId.length){t.next=5;break}return o["a"].$emit("show-notification-message","Ошибка: Необходимо задать ID для поиска"),t.abrupt("return");case 5:return t.next=7,e.getPlayer({idType:e.socialMap[e.selectedSocialOption],id:e.socialId});case 7:if(a=t.sent,a.error){t.next=12;break}e.playerData=a,t.next=24;break;case 12:if(null===(r=a.error.response)||void 0===r||!r.status){t.next=23;break}t.t0=a.error.response.status,t.next=404===t.t0?16:18;break;case 16:return s="Игрок не найден",t.abrupt("break",20);case 18:return s="Необработанная ошибка ".concat(a.error.response.status),t.abrupt("break",20);case 20:o["a"].$emit("show-notification-message","Ошибка: ".concat(s)),t.next=24;break;case 23:o["a"].$emit("show-notification-message","Ошибка: ".concat(a.error.toString()));case 24:return t.next=26,e.getUserProgress(e.playerData.id);case 26:e.progressData=t.sent;case 27:case"end":return t.stop()}}),t)})))()},getCurrencyName:function(e){return this.$store.state.currencies.list.find((function(t){return t.id===e})).name},getSocialLink:function(e,t){switch(e){case"facebook":return"https://facebook.com/id".concat(t);default:return t}},onResetPlayerClick:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!confirm("Вы уверены, что хотите обнулить игрока?")){t.next=5;break}return t.next=3,e.resetPlayer(e.playerData.id);case 3:a=t.sent,a.error?o["a"].$emit("show-notification-message","Ошибка: ".concat(a.error.toString())):e.playerData=a;case 5:case"end":return t.stop()}}),t)})))()},onTesterFlagChanged:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.setTesterFlag({playerId:t.playerData.id,isTester:e.target.checked});case 2:r=a.sent,r.error?o["a"].$emit("show-notification-message","Ошибка: ".concat(r.error.toString())):t.playerData=r;case 4:case"end":return a.stop()}}),a)})))()},onSetChapterClick:function(){g(this.playerData.id,this.progressData)},setUserCurrency:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.updateUserCurrency({playerId:e.playerData.id,money:e.playerData.monies});case 2:a=t.sent,a.error?o["a"].$emit("show-notification-message","Ошибка: ".concat(a.error.toString())):(o["a"].$emit("show-notification-message","Обновлено"),e.playerData.monies=a);case 4:case"end":return t.stop()}}),t)})))()}})},_=b,y=(a("1de0"),Object(h["a"])(_,r,s,!1,null,null,null));t["default"]=y.exports},c650:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page recommended-stories-page"},[a("div",{staticClass:"page__title"},[a("nav-back"),e._v(" Порядок рекомендованных историй ")],1),a("div",{staticClass:"recommended-stories-page__list"},[a("draggable",e._b({staticClass:"list-group",attrs:{tag:"ul",move:e.onStoryMoved},on:{start:function(t){e.dragging=!0},end:function(t){e.dragging=!1},change:e.onOrderChanged},model:{value:e.storiesList,callback:function(t){e.storiesList=t},expression:"storiesList"}},"draggable",e.dragOptions,!1),[a("transition-group",{staticClass:"d-flex flex-wrap",attrs:{type:"transition",name:"flip-list"}},e._l(e.storiesList,(function(t){return a("li",{key:t.id,staticClass:"list-group-item recommended-stories-page__story-item"},[e._v(" "+e._s(t.order_recommended||0)+": "+e._s(t.title)+" (ID: "+e._s(t.id)+") ")])})),0)],1)],1)])},s=[],n=a("1da1"),i=a("5530"),o=(a("96cf"),a("d3b7"),a("3ca3"),a("ddb0"),a("159b"),a("25f0"),a("d81d"),a("b76a")),c=a.n(o),l=a("2f62"),u=a("a70a"),d=a("ed08"),p={data:function(){return{dragging:!1,storiesList:[],dragLocked:!1}},components:{draggable:c.a,NavBack:function(){return a.e("chunk-49c533a1").then(a.bind(null,"e019"))}},computed:{stories:function(){return this.$store.state.firebase.config.Stories.stories},dragOptions:function(){return{animation:0,group:"description",disabled:!1,ghostClass:"ghost"}}},methods:Object(i["a"])(Object(i["a"])(Object(i["a"])({},Object(l["b"])("firebase",["getConfig","updateStoriesRecommendedOrder"])),Object(l["b"])("stories",[""])),{},{onStoryMoved:function(){return!this.dragLocked},onOrderChanged:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.dragLocked=!0,e.storiesList.forEach((function(t,a){return t.order_recommended=e.storiesList.length-a})),e.storiesList=Object(d["d"])(e.storiesList,"order_recommended"),a={},e.storiesList.forEach((function(e){return a[e.id]=e.order_recommended})),t.next=7,e.updateStoriesRecommendedOrder(a);case 7:r=t.sent,e.dragLocked=!1,r.error?u["a"].$emit("show-notification-message","Ошибка: ".concat(r.error.toString())):u["a"].$emit("show-notification-message","Порядок обновлен");case 10:case"end":return t.stop()}}),t)})))()}}),created:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getConfig();case 2:e.storiesList=e.stories.map((function(e){return{id:e.id,title:e.title,order_recommended:e.order_recommended}})),e.storiesList=Object(d["d"])(e.storiesList,"order_recommended");case 4:case"end":return t.stop()}}),t)})))()}},f=p,h=(a("f467"),a("2877")),m=Object(h["a"])(f,r,s,!1,null,null,null);t["default"]=m.exports},d49d:function(e,t,a){"use strict";a("fe08")},e494:function(e,t,a){},e6ea:function(e,t,a){},ef98:function(e,t,a){"use strict";a("29b4")},f467:function(e,t,a){"use strict";a("aa48")},fe08:function(e,t,a){}}]);
//# sourceMappingURL=products.8f92d65f.js.map