(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-271b4faa"],{"48a3":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"multi-packs-list mb-4"},[t.ready?t._l(t.packsList,(function(e,i){return a("div",{key:i,staticClass:"multi-packs-list__pack"},[a("div",{staticClass:"multi-packs-list__pack-name mb-2"},[t._v("Pack #"+t._s(e.id))]),a("table",{staticClass:"table table-striped multi-packs-list__table"},[t._m(0,!0),a("tbody",[a("tr",[a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.google_id,expression:"pack.google_id"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:e.google_id},on:{input:function(a){a.target.composing||t.$set(e,"google_id",a.target.value)}}})]),a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.apple_id,expression:"pack.apple_id"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:e.apple_id},on:{input:function(a){a.target.composing||t.$set(e,"apple_id",a.target.value)}}})]),a("td",[a("input",{directives:[{name:"model",rawName:"v-model.number",value:t.firstBonus[e.id],expression:"firstBonus[pack.id]",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"0",oninput:"validity.valid||(value=0)"},domProps:{value:t.firstBonus[e.id]},on:{change:function(a){return t.onFirstBonusChange(e.id,a)},input:function(a){a.target.composing||t.$set(t.firstBonus,e.id,t._n(a.target.value))},blur:function(e){return t.$forceUpdate()}}})]),a("td",[a("svg",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"bi bi-check-square",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",viewBox:"0 0 16 16",title:"Сохранить"},on:{click:function(a){return t.onSavePackClick(e)}}},[a("path",{attrs:{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"}}),a("path",{attrs:{d:"M10.97 4.97a.75.75 0 0 1 1.071 1.05l-3.992 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.235.235 0 0 1 .02-.022z"}})]),a("svg",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"bi bi-trash ms-3 ml-2",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",viewBox:"0 0 16 16",title:"Удалить"},on:{click:function(a){return t.onDeletePackClick(e.id)}}},[a("path",{attrs:{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"}}),a("path",{attrs:{"fill-rule":"evenodd",d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"}})])])])])]),a("table",{staticClass:"table table-striped multi-packs-list__table multi-packs-list__table--rewards"},[t._m(1,!0),a("tbody",t._l(e.rewards,(function(i,r){return a("tr",{key:i.id},[a("td",[a("b-form-select",{staticClass:"form-control",attrs:{options:t.currenciesOptions},model:{value:t.selectedCurrencies[e.id][r],callback:function(a){t.$set(t.selectedCurrencies[e.id],r,a)},expression:"selectedCurrencies[pack.id][i]"}})],1),a("td",[a("input",{directives:[{name:"model",rawName:"v-model.number",value:t.rewardValues[e.id][r],expression:"rewardValues[pack.id][i]",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"1",oninput:"validity.valid||(value=0)"},domProps:{value:t.rewardValues[e.id][r]},on:{input:function(a){a.target.composing||t.$set(t.rewardValues[e.id],r,t._n(a.target.value))},blur:function(e){return t.$forceUpdate()}}})]),a("td"),a("td",[a("svg",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"bi bi-trash ms-3 ml-2",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",viewBox:"0 0 16 16",title:"Удалить"},on:{click:function(a){return t.onDeletePackRewardClick(e.id,i.id)}}},[a("path",{attrs:{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"}}),a("path",{attrs:{"fill-rule":"evenodd",d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"}})])])])})),0)]),t.availableCurrencies.length>0?a("div",{staticClass:"d-flex"},[a("ui-button",{staticClass:"multi-packs-list__add-button",on:{clicked:function(a){return t.onAddPackRewardClick(e.id)}}},[t._v(" Добавить валюту ")])],1):t._e()])})):t._e(),a("div",{staticClass:"d-flex",staticStyle:{width:"100%"}},[a("ui-button",{staticClass:"multi-packs-list__add-button",on:{clicked:t.onAddPackClick}},[t._v(" Добавить пак ")])],1)],2)},r=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",{attrs:{scope:"col"}},[t._v("Google ID")]),a("th",{attrs:{scope:"col"}},[t._v("Apple ID")]),a("th",{attrs:{scope:"col"}},[t._v("Бонус покупки %")]),a("th",{attrs:{scope:"col"}},[t._v("Действия")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",{attrs:{scope:"col"}},[t._v("Валюта")]),a("th",{attrs:{scope:"col"}},[t._v("Кол-во")]),a("th",{attrs:{scope:"col"}}),a("th",{attrs:{scope:"col"}},[t._v("Действия")])])])}],s=a("53ca"),n=a("5530"),o=a("1da1"),c=(a("96cf"),a("159b"),a("caad"),a("4de4"),a("d3b7"),a("3ca3"),a("ddb0"),a("d81d"),a("b0c0"),a("7db0"),a("25f0"),a("2f62")),u=a("14b9"),l=a("a70a"),d={props:{packs:Array},data:function(){return{ready:!1,packsList:[],currenciesOptions:[],selectedCurrencies:{},rewardValues:{},firstBonus:{}}},computed:{currencies:function(){return this.$store.state.currencies.list},availableCurrencies:function(){var t=[];return this.packsList.forEach((function(e){e.rewards.forEach((function(e){return!t.includes(e.id)&&t.push(e.id)}))})),this.$store.state.firebase.config.Currencies.filter((function(e){return!t.includes(e.id)}))}},components:{UiButton:function(){return a.e("chunk-7a628425").then(a.bind(null,"832a"))}},created:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getConfig();case 2:t.updateComponent(),l["a"].$off("products-list-updated").$on("products-list-updated",t.onProductsUpdated);case 4:case"end":return e.stop()}}),e)})))()},beforeDestroy:function(){l["a"].$off("products-list-updated",this.onProductsUpdated)},methods:Object(n["a"])(Object(n["a"])({},Object(c["b"])("firebase",["getConfig","saveProduct","deleteProduct"])),{},{updateComponent:function(){var t=this;this.packsList=this.packs,this.packsList.forEach((function(e){return t.firstBonus[e.id]=Math.max(e.first_bonus,0)})),this.fillSelects()},onProductsUpdated:function(t){t&&this.updateComponent()},fillSelects:function(){var t=this;this.currenciesOptions=this.$store.state.firebase.config.Currencies.filter((function(t){return t.id>0})).map((function(t){return{value:t.id,text:t.name}})),this.packsList.forEach((function(e){t.selectedCurrencies[e.id]=e.rewards.map((function(t){return t.id})),t.rewardValues[e.id]=e.rewards.map((function(t){return t.value}))})),this.ready=!0},onAddPackRewardClick:function(t){this.packsList.find((function(e){return e.id===t})).rewards.push({id:this.availableCurrencies[0].id,value:0}),this.fillSelects()},onDeletePackRewardClick:function(t,e){confirm("Подтвердите удаление")&&(this.packsList.some((function(a){if(a.id===t)return a.rewards=a.rewards.filter((function(t){return t.id!==e})),!0})),this.forceUpdate())},onSavePackClick:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var i,r,n,o,c,u,d;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:i={},r=[],n=function(a){if(!e.rewardValues[t.id][a])return l["a"].$emit("show-notification-message","Не должно быть нулевых значений валют"),{v:void 0};if(i[e.selectedCurrencies[t.id][a]]){var s=e.currencies.find((function(i){return i.id===e.selectedCurrencies[t.id][a]}));return l["a"].$emit("show-notification-message","Найдены дубликаты наград: ".concat(s.name)),{v:void 0}}i[e.selectedCurrencies[a]]=1,r.push({id:parseInt(e.selectedCurrencies[t.id][a],10),value:parseInt(e.rewardValues[t.id][a],10)})},o=0;case 4:if(!(o<e.selectedCurrencies[t.id].length)){a.next=11;break}if(c=n(o),"object"!==Object(s["a"])(c)){a.next=8;break}return a.abrupt("return",c.v);case 8:o++,a.next=4;break;case 11:return u={id:t.id,google_id:t.google_id,apple_id:t.apple_id,first_bonus:parseInt(e.firstBonus[t.id],10)||0,rewards:r},a.next=14,e.saveProduct(u);case 14:d=a.sent,d.error?l["a"].$emit("show-notification-message","Ошибка: ".concat(d.error.toString())):(l["a"].$emit("show-notification-message","Обновлено"),e.$forceUpdate());case 16:case"end":return a.stop()}}),a)})))()},onDeletePackClick:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(confirm("Подтвердите удаление")){a.next=2;break}return a.abrupt("return");case 2:return a.next=4,e.deleteProduct(t);case 4:i=a.sent,i.error?l["a"].$emit("show-notification-message","Ошибка: ".concat(i.error.toString())):(l["a"].$emit("show-notification-message","Удалено"),e.packsList=e.packsList.filter((function(e){return e.id!==t})),e.forceUpdate());case 6:case"end":return a.stop()}}),a)})))()},onAddPackClick:function(){Object(u["a"])()},forceUpdate:function(){this.$forceUpdate(),this.fillSelects()},onFirstBonusChange:function(t,e){var a=parseInt(e.target.value,10);isNaN(a)&&(a=0),this.firstBonus[t]=a}})},p=d,f=(a("6608"),a("2877")),m=Object(f["a"])(p,i,r,!1,null,null,null);e["default"]=m.exports},6608:function(t,e,a){"use strict";a("ee87")},ee87:function(t,e,a){}}]);
//# sourceMappingURL=chunk-271b4faa.8ba2f5a5.js.map