(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["products"],{"14b9":function(t,e,n){"use strict";n.d(e,"a",(function(){return v}));var r=n("bc87"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"modal-popup"},[n("div",{staticClass:"mb-3 modal-popup__title"},[t._v(" Добавление пака "),n("svg",{staticClass:"bi bi-x-lg modal-popup__close",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"#2D4C70",viewBox:"0 0 16 16"},on:{click:t.close}},[n("path",{attrs:{d:"M1.293 1.293a1 1 0 0 1 1.414 0L8 6.586l5.293-5.293a1 1 0 1 1 1.414 1.414L9.414 8l5.293 5.293a1 1 0 0 1-1.414 1.414L8 9.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L6.586 8 1.293 2.707a1 1 0 0 1 0-1.414z"}})])]),n("div",{staticClass:"input-group"},[n("label",{staticClass:"modal-popup__label text-left",staticStyle:{width:"100%"}},[t._v("Google ID")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.googleID,expression:"googleID"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.googleID},on:{input:function(e){e.target.composing||(t.googleID=e.target.value)}}})]),n("div",{staticClass:"input-group mb-3"},[n("label",{staticClass:"modal-popup__label text-left",staticStyle:{width:"100%"}},[t._v("Apple ID")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.appleID,expression:"appleID"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.appleID},on:{input:function(e){e.target.composing||(t.appleID=e.target.value)}}})]),n("div",{staticClass:"input-group mb-3"},[n("label",{staticClass:"modal-popup__label text-left",staticStyle:{width:"100%"}},[t._v("Бонус первой покупки %")]),n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.firstBonus,expression:"firstBonus",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"0",oninput:"validity.valid||(value=0)"},domProps:{value:t.firstBonus},on:{input:function(e){e.target.composing||(t.firstBonus=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]),t._l(t.rewards,(function(e,r){return n("div",{staticClass:"input-group mb-3 align-items-center"},[n("b-form-select",{staticClass:"form-control",attrs:{options:t.currenciesOptions},model:{value:t.selectedCurrencies[r],callback:function(e){t.$set(t.selectedCurrencies,r,e)},expression:"selectedCurrencies[i]"}}),n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.rewards[r].value,expression:"rewards[i].value",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"1",oninput:"validity.valid||(value=0)"},domProps:{value:t.rewards[r].value},on:{input:function(e){e.target.composing||t.$set(t.rewards[r],"value",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),n("svg",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"bi bi-trash ms-3 ml-2",staticStyle:{cursor:"pointer"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",viewBox:"0 0 16 16",title:"Удалить"},on:{click:function(e){return t.onDeleteRewardClick(r)}}},[n("path",{attrs:{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"}}),n("path",{attrs:{"fill-rule":"evenodd",d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"}})])],1)})),n("div",{staticClass:"d-flex justify-content-center",staticStyle:{width:"100%"}},[n("ui-button",{staticClass:"mt-3 mb-2 d-flex",staticStyle:{width:"200px"},on:{clicked:t.onAddRewardClick}},[t._v(" Добавить валюту ")])],1),n("div",{staticClass:"d-flex justify-content-center",staticStyle:{width:"100%"}},[n("ui-button",{staticClass:"mt-3 mb-2",staticStyle:{width:"200px"},on:{clicked:t.onSaveClick}},[t._v("Сохранить")])],1),t.alert.length?n("div",{staticClass:"alert alert-danger",attrs:{role:"alert"}},[t._v(t._s(t.alert))]):t._e()],2)},a=[],i=n("53ca"),o=n("1da1"),c=n("5530"),u=(n("96cf"),n("d3b7"),n("3ca3"),n("ddb0"),n("d81d"),n("4de4"),n("b0c0"),n("7db0"),n("a434"),n("2f62")),l=n("a70a"),d={data:function(){return{alert:"",canReset:!1,currenciesOptions:[],selectedCurrencies:[],rewards:[],googleID:"",appleID:"",firstBonus:0}},computed:Object(c["a"])(Object(c["a"])({},Object(u["c"])("firebase",["getNewProductID"])),{},{currencies:function(){return this.$store.state.firebase.config.Currencies}}),components:{UiButton:function(){return n.e("chunk-7a628425").then(n.bind(null,"832a"))}},mounted:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getConfig();case 2:case"end":return e.stop()}}),e)})))()},methods:Object(c["a"])(Object(c["a"])({},Object(u["b"])("firebase",["getConfig","saveProduct"])),{},{resetAlert:function(){this.canReset&&(this.alert="",this.canReset=!1)},setAlert:function(t){var e=this;this.alert=t,setTimeout((function(t){return e.canReset=!0}),250)},fillSelects:function(){this.currenciesOptions=this.currencies.filter((function(t){return t.id>0})).map((function(t){return{value:t.id,text:t.name}}))},onSaveClick:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var n,r,s,a,o,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.googleID.length){e.next=3;break}return t.setAlert("Необходимо указать Google ID товара"),e.abrupt("return");case 3:if(t.appleID.length){e.next=6;break}return t.setAlert("Необходимо указать Apple ID товара"),e.abrupt("return");case 6:if(t.rewards.length){e.next=9;break}return t.setAlert("Необходимо задать хотя бы 1 валюту"),e.abrupt("return");case 9:n={},r=[],s=function(e){if(!t.rewards[e].value)return t.setAlert("Не должно быть нулевых значений валют"),{v:void 0};if(n[t.selectedCurrencies[e]]){var s=t.currencies.find((function(n){return n.id===t.selectedCurrencies[e]}));return t.setAlert("Найдены дубликаты наград: ".concat(s.name)),{v:void 0}}n[t.selectedCurrencies[e]]=1,r.push({id:t.selectedCurrencies[e],value:t.rewards[e].value})},a=0;case 13:if(!(a<t.rewards.length)){e.next=20;break}if(o=s(a),"object"!==Object(i["a"])(o)){e.next=17;break}return e.abrupt("return",o.v);case 17:a++,e.next=13;break;case 20:return e.next=22,t.saveProduct({id:t.getNewProductID,google_id:t.googleID,apple_id:t.appleID,first_bonus:t.firstBonus,rewards:r});case 22:c=e.sent,c.error?t.setAlert("Ошибка добавления"):(c.rewards.length>1&&l["a"].$emit("products-list-updated",c),t.close());case 24:case"end":return e.stop()}}),e)})))()},onAddRewardClick:function(){this.rewards.push({id:1,value:1}),this.selectedCurrencies.push(1),this.fillSelects()},close:function(){this.$modal.hide("add-multi-pack-modal")},onDeleteRewardClick:function(t){this.rewards.splice(t,1),this.selectedCurrencies.splice(t,1),this.fillSelects()}})},p=d,f=(n("3c6e"),n("2877")),m=Object(f["a"])(p,s,a,!1,null,null,null),g=m.exports,v=function(){var t=new r["a"]({component:g,props:{},params:{transition:"scale",name:"add-multi-pack-modal",width:"100%",height:"100%",classes:"modal-popup__overlay"}});t.show()}},"29b4":function(t,e,n){},"3c6e":function(t,e,n){"use strict";n("e6ea")},a551:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.pageIsReady?n("div",{staticClass:"page products-page"},[n("div",{staticClass:"page__title"},[n("nav-back"),t._v(" Список товаров "),n("ui-button",{staticStyle:{position:"absolute",right:"0"},on:{clicked:t.onSortingButtonClick}},[t._v("Сортировка")])],1),n("h1",[t._v("Мульти-паки")]),t.pageIsReady?n("multi-packs-list",{attrs:{packs:t.multiPacksList}}):t._e(),n("h1",[t._v("Одиночные паки")]),t._l(Object.keys(t.singlePacksList),(function(e){return t.pageIsReady?n("packs-list",t._b({key:e,attrs:{packs:t.singlePacksList[e]}},"packs-list",t.getCurrencyData(parseInt(e,10)),!1)):t._e()})),Object.keys(t.singlePacksList).length?t._e():[n("ui-button",{staticClass:"products-page__add-single-pack-button",on:{clicked:t.onAddSinglePackClick}},[t._v(" Добавить товар ")])]],2):t._e()},s=[],a=n("1da1"),i=n("5530"),o=(n("96cf"),n("d3b7"),n("3ca3"),n("ddb0"),n("4de4"),n("2f62")),c=n("bc87"),u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"modal-popup",on:{click:t.resetAlert,keyup:function(e){return e.type.indexOf("key")||13===e.keyCode?t.onSaveClick.apply(null,arguments):null}}},[n("div",{staticClass:"mb-3 modal-popup__title"},[t._v(" Порядок вывода товаров "),n("svg",{staticClass:"bi bi-x-lg modal-popup__close",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"#2D4C70",viewBox:"0 0 16 16"},on:{click:t.close}},[n("path",{attrs:{d:"M1.293 1.293a1 1 0 0 1 1.414 0L8 6.586l5.293-5.293a1 1 0 1 1 1.414 1.414L9.414 8l5.293 5.293a1 1 0 0 1-1.414 1.414L8 9.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L6.586 8 1.293 2.707a1 1 0 0 1 0-1.414z"}})])]),t.popupIsReady?n("div",{staticClass:"products-sorting-modal__selects-group"},t._l(t.productsList,(function(e,r){return n("b-form-select",{key:r,staticClass:"form-control",attrs:{options:t.productsOptions},model:{value:t.productsList[r],callback:function(e){t.$set(t.productsList,r,e)},expression:"productsList[i]"}})})),1):t._e(),n("ui-button",{staticClass:"mb-2",on:{clicked:t.onSaveClick}},[t._v("Сохранить")]),t.alert.length?n("div",{class:["alert",t.alertClass],attrs:{role:"alert"}},[t._v(t._s(t.alert))]):t._e()],1)},l=[],d=n("53ca"),p=(n("d81d"),n("07ac"),n("7db0"),{data:function(){return{alert:"",alertClass:"",canReset:!1,productsOptions:[],productsList:[],popupIsReady:!1}},components:{UiButton:function(){return n.e("chunk-7a628425").then(n.bind(null,"832a"))}},computed:{products:function(){return this.$store.state.firebase.config.Products.products}},created:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getConfig();case 2:t.fillSelects();case 3:case"end":return e.stop()}}),e)})))()},methods:Object(i["a"])(Object(i["a"])({},Object(o["b"])("firebase",["getConfig","updateProductsOrder"])),{},{close:function(){this.$modal.hide("products-sorting-modal")},fillSelects:function(){this.productsOptions=Object.values(this.products).map((function(t){return{text:t.google_id,value:t.id}}));for(var t=0;t<this.productsOptions.length;t++)this.productsList[t]=this.productsOptions[t].value;this.popupIsReady=!0},resetAlert:function(){this.canReset&&(this.alert="",this.canReset=!1)},setAlert:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.alert=t,this.alertClass=n?"alert-danger":"alert-success",setTimeout((function(){e.canReset=!0}),250)},onSaveClick:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n,r,s,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n={},r=function(e){if(n[t.productsList[e]]){var r=t.products.find((function(n){return n.id===t.productsList[e]}));return t.setAlert("Найден дубликат товара: ".concat(r.google_id)),{v:void 0}}n[t.productsList[e]]=1},s=0;case 3:if(!(s<t.productsList.length)){e.next=10;break}if(a=r(s),"object"!==Object(d["a"])(a)){e.next=7;break}return e.abrupt("return",a.v);case 7:s++,e.next=3;break;case 10:return e.next=12,t.updateProductsOrder(t.productsList);case 12:i=e.sent,i.error?t.setAlert("Ошибка обновления"):t.setAlert("Успешно сохранено",!1);case 14:case"end":return e.stop()}}),e)})))()}})}),f=p,m=(n("ef98"),n("2877")),g=Object(m["a"])(f,u,l,!1,null,null,null),v=g.exports,h=function(t){var e=new c["a"]({component:v,params:{transition:"scale",name:"products-sorting-modal",width:"100%",height:"100%",classes:"modal-popup__overlay"}});e.show()},b=n("14b9"),w=n("a70a"),k={data:function(){return{pageIsReady:!1}},components:{NavBack:function(){return n.e("chunk-49c533a1").then(n.bind(null,"e019"))},UiButton:function(){return n.e("chunk-7a628425").then(n.bind(null,"832a"))},PacksList:function(){return n.e("chunk-c01be8d8").then(n.bind(null,"cf4a"))},MultiPacksList:function(){return n.e("chunk-271b4faa").then(n.bind(null,"48a3"))}},computed:Object(i["a"])(Object(i["a"])({},Object(o["c"])("firebase",["getCurrencyById","getMultiProductsList","getSingleProductsList"])),{},{currencies:function(){return this.$store.state.firebase.config.Currencies.filter((function(t){return 0!==t.id}))},singlePacksList:function(){return this.getSingleProductsList},multiPacksList:function(){return this.getMultiProductsList}}),created:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getConfig();case 2:w["a"].$off("products-list-updated").$on("products-list-updated",t.onProductsUpdated),t.pageIsReady=!0;case 4:case"end":return e.stop()}}),e)})))()},beforeDestroy:function(){w["a"].$off("products-list-updated",this.onProductsUpdated)},methods:Object(i["a"])(Object(i["a"])({},Object(o["b"])("firebase",["getConfig"])),{},{onSortingButtonClick:function(){h()},onProductsUpdated:function(){this.$forceUpdate()},onAddSinglePackClick:function(){Object(b["a"])()},getCurrencyData:function(t){return this.getCurrencyById(t)}})},_=k,C=(n("d49d"),Object(m["a"])(_,r,s,!1,null,null,null));e["default"]=C.exports},aa48:function(t,e,n){},bc87:function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}n.d(e,"a",(function(){return c}));n("b0c0");var i=n("1881"),o=n.n(i),c=function(){function t(e){var n=e.component,s=e.props,a=void 0===s?{}:s,i=e.params,o=void 0===i?{}:i,c=e.events,u=void 0===c?{}:c;r(this,t),this.component=n,this.props=a,this.params=o,this.events={opened:function(){Object.assign(n,{modalName:o.name})},closed:function(){}},Object.assign(this.events,u)}return a(t,[{key:"show",value:function(){o.a.rootInstance.$modal.show(this.component,this.props,this.params,this.events)}},{key:"hide",value:function(){o.a.rootInstance.$emit("close")}}]),t}()},c650:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page recommended-stories-page"},[n("div",{staticClass:"page__title"},[n("nav-back"),t._v(" Порядок рекомендованных историй ")],1),n("div",{staticClass:"recommended-stories-page__list"},[n("draggable",t._b({staticClass:"list-group",attrs:{tag:"ul",move:t.onStoryMoved},on:{start:function(e){t.dragging=!0},end:function(e){t.dragging=!1},change:t.onOrderChanged},model:{value:t.storiesList,callback:function(e){t.storiesList=e},expression:"storiesList"}},"draggable",t.dragOptions,!1),[n("transition-group",{staticClass:"d-flex flex-wrap",attrs:{type:"transition",name:"flip-list"}},t._l(t.storiesList,(function(e){return n("li",{key:e.id,staticClass:"list-group-item recommended-stories-page__story-item"},[t._v(" "+t._s(e.order_recommended||0)+": "+t._s(e.title)+" (ID: "+t._s(e.id)+") ")])})),0)],1)],1)])},s=[],a=n("1da1"),i=n("5530"),o=(n("96cf"),n("d3b7"),n("3ca3"),n("ddb0"),n("159b"),n("25f0"),n("d81d"),n("b76a")),c=n.n(o),u=n("2f62"),l=n("a70a"),d=n("ed08"),p={data:function(){return{dragging:!1,storiesList:[],dragLocked:!1}},components:{draggable:c.a,NavBack:function(){return n.e("chunk-49c533a1").then(n.bind(null,"e019"))}},computed:{stories:function(){return this.$store.state.firebase.config.Stories.stories},dragOptions:function(){return{animation:0,group:"description",disabled:!1,ghostClass:"ghost"}}},methods:Object(i["a"])(Object(i["a"])(Object(i["a"])({},Object(u["b"])("firebase",["getConfig","updateStoriesRecommendedOrder"])),Object(u["b"])("stories",[""])),{},{onStoryMoved:function(){return!this.dragLocked},onOrderChanged:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.dragLocked=!0,t.storiesList.forEach((function(e,n){return e.order_recommended=t.storiesList.length-n})),t.storiesList=Object(d["b"])(t.storiesList,"order_recommended"),n={},t.storiesList.forEach((function(t){return n[t.id]=t.order_recommended})),e.next=7,t.updateStoriesRecommendedOrder(n);case 7:r=e.sent,t.dragLocked=!1,r.error?l["a"].$emit("show-notification-message","Ошибка: ".concat(r.error.toString())):l["a"].$emit("show-notification-message","Порядок обновлен");case 10:case"end":return e.stop()}}),e)})))()}}),created:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getConfig();case 2:t.storiesList=t.stories.map((function(t){return{id:t.id,title:t.title,order_recommended:t.order_recommended}})),t.storiesList=Object(d["b"])(t.storiesList,"order_recommended");case 4:case"end":return e.stop()}}),e)})))()}},f=p,m=(n("f467"),n("2877")),g=Object(m["a"])(f,r,s,!1,null,null,null);e["default"]=g.exports},d49d:function(t,e,n){"use strict";n("fe08")},e6ea:function(t,e,n){},ef98:function(t,e,n){"use strict";n("29b4")},f467:function(t,e,n){"use strict";n("aa48")},fe08:function(t,e,n){}}]);
//# sourceMappingURL=products.7c1f6db0.js.map